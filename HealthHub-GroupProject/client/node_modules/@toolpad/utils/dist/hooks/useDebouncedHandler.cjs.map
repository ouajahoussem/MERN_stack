{"version":3,"sources":["../../src/hooks/useDebouncedHandler.ts"],"sourcesContent":["import * as React from 'react';\n\ninterface Handler<P extends unknown[]> {\n  (...params: P): void;\n}\n\ninterface DelayedInvocation<P extends unknown[]> {\n  startTime: number;\n  timeout: NodeJS.Timeout;\n  params: P;\n}\n\nfunction clear<P extends unknown[]>(\n  delayedInvocation: React.MutableRefObject<DelayedInvocation<P> | null>,\n) {\n  if (delayedInvocation.current) {\n    clearTimeout(delayedInvocation.current.timeout);\n    delayedInvocation.current = null;\n  }\n}\n\nfunction defer<P extends unknown[]>(\n  fn: React.MutableRefObject<Handler<P>>,\n  params: P,\n  delay: number,\n) {\n  const timeout = setTimeout(() => {\n    fn.current(...params);\n  }, delay);\n\n  return { startTime: Date.now(), timeout, params };\n}\n\n/**\n * Creates a debounced version of the handler that is passed. The invocation of [fn] is\n * delayed for [delay] milliseconds from the last invocation of the debounced function.\n *\n * This implementation adds on the lodash implementation in that it handles updates to the\n * delay value.\n */\nexport default function useDebouncedHandler<P extends unknown[]>(\n  fn: Handler<P>,\n  delay: number,\n): Handler<P> {\n  const fnRef = React.useRef(fn);\n  React.useEffect(() => {\n    fnRef.current = fn;\n  }, [fn]);\n\n  const delayedInvocation = React.useRef<DelayedInvocation<P> | null>(null);\n\n  React.useEffect(() => {\n    if (!delayedInvocation.current) {\n      return;\n    }\n\n    const { startTime, params } = delayedInvocation.current;\n\n    const elapsed = Date.now() - startTime;\n    const newDelay = Math.max(delay - elapsed, 0);\n\n    clear(delayedInvocation);\n    delayedInvocation.current = defer(fnRef, params, newDelay);\n  }, [delay]);\n\n  return React.useCallback(\n    (...params: P) => {\n      clear(delayedInvocation);\n      delayedInvocation.current = defer(fnRef, params, delay);\n    },\n    [delay],\n  );\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAuB;AAYvB,SAAS,MACP,mBACA;AACA,MAAI,kBAAkB,SAAS;AAC7B,iBAAa,kBAAkB,QAAQ,OAAO;AAC9C,sBAAkB,UAAU;AAAA,EAC9B;AACF;AAEA,SAAS,MACP,IACA,QACA,OACA;AACA,QAAM,UAAU,WAAW,MAAM;AAC/B,OAAG,QAAQ,GAAG,MAAM;AAAA,EACtB,GAAG,KAAK;AAER,SAAO,EAAE,WAAW,KAAK,IAAI,GAAG,SAAS,OAAO;AAClD;AASe,SAAR,oBACL,IACA,OACY;AACZ,QAAM,QAAc,aAAO,EAAE;AAC7B,EAAM,gBAAU,MAAM;AACpB,UAAM,UAAU;AAAA,EAClB,GAAG,CAAC,EAAE,CAAC;AAEP,QAAM,oBAA0B,aAAoC,IAAI;AAExE,EAAM,gBAAU,MAAM;AACpB,QAAI,CAAC,kBAAkB,SAAS;AAC9B;AAAA,IACF;AAEA,UAAM,EAAE,WAAW,OAAO,IAAI,kBAAkB;AAEhD,UAAM,UAAU,KAAK,IAAI,IAAI;AAC7B,UAAM,WAAW,KAAK,IAAI,QAAQ,SAAS,CAAC;AAE5C,UAAM,iBAAiB;AACvB,sBAAkB,UAAU,MAAM,OAAO,QAAQ,QAAQ;AAAA,EAC3D,GAAG,CAAC,KAAK,CAAC;AAEV,SAAa;AAAA,IACX,IAAI,WAAc;AAChB,YAAM,iBAAiB;AACvB,wBAAkB,UAAU,MAAM,OAAO,QAAQ,KAAK;AAAA,IACxD;AAAA,IACA,CAAC,KAAK;AAAA,EACR;AACF;","names":[]}